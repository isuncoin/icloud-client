var rippleVaultClient=function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){ripple=r(1),t.exports=r(2)},function(t){t.exports=ripple},function(t,e,r){function n(t){t||(t={}),"string"==typeof t&&(t={domain:t}),this.domain=t.domain||"ripple.com",this.infos={}}var o=r(8),i=r(3).BlobClient,a=r(3).Blob,s=r(4).AuthInfo,u=r(5).RippleTxt,c=r(6).Crypt;n.prototype.getAuthInfo=function(t,e){s.get(this.domain,t,function(t,r){return t?e(t):3!==r.version?e(new Error("This wallet is incompatible with this version of the vault-client.")):r.pakdf?"string"!=typeof r.blobvault?e(new Error("No blobvault specified in the authinfo.")):void e(null,r):e(new Error("No settings for PAKDF in auth packet."))})},n.prototype._deriveLoginKeys=function(t,e,r){var n=t.username.toLowerCase().replace(/-/g,"");c.derive(t.pakdf,"login",n,e,function(n,o){n?r(n):r(null,t,e,o)})},n.prototype._deriveUnlockKey=function(t,e,r,n){var o=t.username.toLowerCase().replace(/-/g,"");c.derive(t.pakdf,"unlock",o,e,function(e,o){return e?(console.log("error","derive:",e),n(e)):(r||(r={}),r.unlock=o.unlock,void n(null,t,r))})},n.prototype.getRippleName=function(t,e,r){e?i.getRippleName(e,t,r):r(new Error("Blob vault URL is required"))},n.prototype.exists=function(t,e){s.get(this.domain,t.toLowerCase(),function(t,r){t?e(t):e(null,!!r.exists)})},n.prototype.addressExists=function(t,e){s.getAddress(this.domain,t,function(t,r){t?e(t):e(null,!!r.addressExists)})},n.prototype.login=function(t,e,r,n){function a(r){l.getAuthInfo(t,function(t,n){return n&&!n.exists?r(new Error("User does not exist.")):r(t,n,e)})}function s(t,e,n,o){var a={url:t.blobvault,blob_id:n.id,key:n.crypt,device_id:r};i.get(a,function(r,i){return r?o(r):(l.infos[n.id]=t,i.missing_fields&&i.missing_fields.encrypted_blobdecrypt_key&&(console.log("migration: saving encrypted blob decrypt key"),t.blob=i,l._deriveUnlockKey(t,e,n,u)),void o(null,{blob:i,username:t.username,verified:t.emailVerified,emailVerified:t.emailVerified,profileVerified:t.profile_verified,identityVerified:t.identity_verified}))})}function u(t,e,r){if(!t&&r.unlock){var n;try{n=c.decrypt(r.unlock,e.blob.encrypted_secret)}catch(o){return console.log("error:","decrypt:",o)}options={username:e.username,blob:e.blob,masterkey:n,keys:r},i.updateKeys(options,function(t){t&&console.log("error:","updateKeys:",t)})}}var l=this,p=[a,l._deriveLoginKeys,s];o.waterfall(p,n)},n.prototype.relogin=function(t,e,r,n,o){if(!t&&this.infos[e]&&(t=this.infos[e].blobvault),!t)return o(new Error("Blob vault URL is required"));var a={url:t,blob_id:e,key:r,device_id:n};i.get(a,function(t,e){t?o(t):o(null,{blob:e})})},n.prototype.unlock=function(t,e,r,n){function i(r){s.getAuthInfo(t,function(t,n){return n&&!n.exists?r(new Error("User does not exist.")):r(t,n,e,{})})}function a(t,e,n){var o;try{o=c.decrypt(e.unlock,r)}catch(i){return n(i)}n(null,{keys:e,secret:o})}var s=this,u=[i,s._deriveUnlockKey,a];o.waterfall(u,n)},n.prototype.loginAndUnlock=function(t,e,r,n){function i(n){u.login(t,e,r,function(t,r){if(t)return n(t);if(!r.blob||!r.blob.encrypted_secret)return n(new Error("Unable to retrieve blob and secret."));if(!r.blob.id||!r.blob.key)return n(new Error("Unable to retrieve keys."));var o=u.infos[r.blob.id];return o?void n(null,o,e,r.blob):n(new Error("Unable to find authInfo"))})}function a(t,e,r,n){u._deriveUnlockKey(t,e,null,function(t,e,o){n(t,o.unlock,e,r)})}function s(t,e,r,n){var o;try{o=c.decrypt(t,r.encrypted_secret)}catch(i){return n(i)}n(null,{blob:r,unlock:t,secret:o,username:e.username,verified:e.emailVerified,emailVerified:e.emailVerified,profileVerified:e.profile_verified,identityVerified:e.identity_verified})}var u=this,l=[i,a,s];o.waterfall(l,n)},n.prototype.verify=function(t,e,r){var n=this;n.getAuthInfo(t,function(n,o){return n?r(n):void i.verify(o.blobvault,t.toLowerCase(),e,r)})},n.prototype.changePassword=function(t,e){function r(e){a.getAuthInfo(t.username,function(t,r){return e(t,r,s)})}function n(e,r,n){t.keys=r,i.updateKeys(t,n)}var a=this,s=String(t.password).trim(),u=[r,a._deriveLoginKeys,a._deriveUnlockKey,n];o.waterfall(u,e)},n.prototype.rename=function(t,e){function r(t){a.getAuthInfo(s,function(e,r){return r&&r.exists?t(new Error("username already taken.")):(r.username=s,t(e,r,u))})}function n(e,r,n){t.keys=r,i.rename(t,n)}var a=this,s=String(t.new_username).trim(),u=String(t.password).trim(),c=[r,a._deriveLoginKeys,a._deriveUnlockKey,n];o.waterfall(c,e)},n.prototype.register=function(t,e){function r(t){a.getAuthInfo(s,function(e,r){return t(e,r,u)})}function n(e,r,n){var o={url:e.blobvault,id:r.id,crypt:r.crypt,unlock:r.unlock,username:s,email:t.email,masterkey:t.masterkey||c.createMaster(),activateLink:t.activateLink,oldUserBlob:t.oldUserBlob,domain:t.domain};i.create(o,function(t,e){t?n(t):n(null,{blob:e,username:s})})}var a=this,s=String(t.username).trim(),u=String(t.password).trim(),l=a.validateUsername(s);if(!l.valid)return e(new Error("invalid username."));var p=[r,a._deriveLoginKeys,a._deriveUnlockKey,n];o.waterfall(p,e)},n.prototype.validateUsername=function(t){t=String(t).trim();var e={valid:!1,reason:""};return t.length<2?e.reason="tooshort":t.length>20?e.reason="toolong":/^[a-zA-Z0-9\-]+$/.exec(t)?/^-/.exec(t)?e.reason="starthyphen":/-$/.exec(t)?e.reason="endhyphen":/--/.exec(t)?e.reason="multhyphen":e.valid=!0:e.reason="charset",e},n.prototype.generateDeviceID=function(){return c.createSecret(4)},n.prototype.resendEmail=i.resendEmail,n.prototype.recoverBlob=i.recoverBlob,n.prototype.deleteBlob=i.deleteBlob,n.prototype.requestToken=i.requestToken,n.prototype.verifyToken=i.verifyToken,n.prototype.getAttestation=i.getAttestation,n.prototype.updateAttestation=i.updateAttestation,n.prototype.getAttestationSummary=i.getAttestationSummary,e.VaultClient=n,e.AuthInfo=s,e.RippleTxt=u,e.Blob=a},function(t,e,r){function n(t){t||(t={}),this.device_id=t.device_id,this.url=t.url,this.id=t.blob_id,this.key=t.key,this.identity=new g(this),this.data={}}function o(t,e){var r=a.deriveRecoveryEncryptionKeyFromSecret(t);return a.decrypt(r,e)}function i(t,e){return/(number|string)/.test(typeof t[0])?t=[t]:1===t.length&&Array.isArray(t[0])&&/(number|string)/.test(typeof t[0][0])||Array.isArray(t[0])&&(t=t[0]),t=t.map(function(t){if("string"==typeof t[0]&&(t[0]=n.ops[t[0]]),"number"!=typeof t[0])throw new Error("Invalid op in subcommand");if("string"!=typeof t[1])throw new Error("Invalid path in subcommand");return t}),e?1===t.length?t[0]:[t]:t}var a=r(6).Crypt,s=r(7).SignedRequest,u=r(12),c=r(9),l=r(8),p={};n.ops={noop:0,set:16,unset:17,extend:18,push:32,pop:33,shift:34,unshift:35,filter:36},n.opsReverseMap=[];for(var f in n.ops)n.opsReverseMap[n.ops[f]]=f;var d="identityVault",h=["name","entityType","email","phone","address","nationalID","birthday","birthplace"],y=["individual","organization","corporation"],m=["contact","line1","line2","city","region","postalCode","country"],b=["number","type","country"],v=["ssn","taxID","passport","driversLicense","other"];n.prototype.init=function(t){var e,r=this;-1===r.url.indexOf("://")&&(r.url="http://"+e),e=r.url+"/v1/blob/"+r.id,this.device_id&&(e+="?device_id="+this.device_id),u.get(e,function(e,n){if(e)return t(new Error(e.message||"Could not retrieve blob"));if(!n.body)return t(new Error("Could not retrieve blob"));if(n.body.twofactor)return n.body.twofactor.blob_id=r.id,n.body.twofactor.blob_url=r.url,n.body.twofactor.device_id=r.device_id,n.body.twofactor.blob_key=r.key,t(n.body);if("success"!==n.body.result)return t(new Error("Incorrect username or password"));if(r.revision=n.body.revision,r.encrypted_secret=n.body.encrypted_secret,r.identity_id=n.body.identity_id,r.id_token=n.body.id_token,r.missing_fields=n.body.missing_fields,!r.decrypt(n.body.blob))return t(new Error("Error while decrypting blob"));if(n.body.patches&&n.body.patches.length){var o=!0;n.body.patches.forEach(function(t){o=o&&r.applyEncryptedPatch(t)}),o&&r.consolidate()}t(null,r)}).timeout(8e3)},n.prototype.consolidate=function(t){"function"!=typeof t&&(t=function(){});var e=this.encrypt(),r={method:"POST",url:this.url+"/v1/blob/consolidate",dataType:"json",data:{blob_id:this.id,data:e,revision:this.revision}},n=new s(r),o=n.signHmac(this.data.auth_secret,this.id);u.post(o.url).send(o.data).end(function(e,r){e?t(new Error("Failed to consolidate blob - XHR error")):r.body&&"success"===r.body.result?t(null,r.body):t(new Error("Failed to consolidate blob"))})},n.prototype.applyEncryptedPatch=function(t){try{var e=JSON.parse(a.decrypt(this.key,t)),r=e.shift(),n=e.shift();return this.applyUpdate(r,n,e),this.revision++,!0}catch(o){return!1}},n.prototype.encryptSecret=function(t,e){return a.encrypt(t,e)},n.prototype.decryptSecret=function(t){return a.decrypt(t,this.encrypted_secret)},n.prototype.decrypt=function(t){try{return this.data=JSON.parse(a.decrypt(this.key,t)),this}catch(e){return!1}},n.prototype.encrypt=function(){return a.encrypt(this.key,JSON.stringify(this.data))},n.prototype.encryptBlobCrypt=function(t,e){var r=a.deriveRecoveryEncryptionKeyFromSecret(t);return a.encrypt(r,e)},n.prototype.set=function(t,e,r){return t=="/"+d&&this.data[d]?r(new Error("Cannot overwrite Identity Vault")):(this.applyUpdate("set",t,[e]),void this.postUpdate("set",t,[e],r))},n.prototype.unset=function(t,e){return t=="/"+d?e(new Error("Cannot remove Identity Vault")):(this.applyUpdate("unset",t,[]),void this.postUpdate("unset",t,[],e))},n.prototype.extend=function(t,e,r){this.applyUpdate("extend",t,[e]),this.postUpdate("extend",t,[e],r)},n.prototype.unshift=function(t,e,r){this.applyUpdate("unshift",t,[e]),this.postUpdate("unshift",t,[e],r)},n.prototype.filter=function(t,e,r,n,o){var a=Array.prototype.slice.apply(arguments);"function"==typeof a[a.length-1]&&(o=a.pop()),a.shift(),a=a.slice(0,2).concat(i(a.slice(2),!0)),this.applyUpdate("filter",t,a),this.postUpdate("filter",t,a,o)},n.prototype.applyUpdate=function(t,e,r){if("number"==typeof t&&(t=n.opsReverseMap[t]),"string"!=typeof t)throw new Error("Blob update op code must be a number or a valid op id string");var o=e.split("/"),i=o.shift();if(""!==i)throw new Error("Invalid JSON pointer: "+e);this._traverse(this.data,o,e,t,r)},n.prototype._traverse=function(t,e,r,n,o){var a=this,s=a.unescapeToken(e.shift());if(Array.isArray(t)){if("-"===s)s=t.length;else if(s%1!==0&&s>=0)throw new Error(0/0)}else{if("object"!=typeof t)return null;if(!t.hasOwnProperty(s))if("set"===n)t[s]={};else{if("unshift"!==n)return null;t[s]=[]}}if(0!==e.length)return this._traverse(t[s],e,r,n,o);switch(n){case"set":t[s]=o[0];break;case"unset":Array.isArray(t)?t.splice(s,1):delete t[s];break;case"extend":if("object"!=typeof t[s])throw new Error("Tried to extend a non-object");c(!0,t[s],o[0]);break;case"unshift":if("undefined"==typeof t[s])t[s]=[];else if(!Array.isArray(t[s]))throw new Error('Operator "unshift" must be applied to an array.');t[s].unshift(o[0]);break;case"filter":Array.isArray(t[s])&&t[s].forEach(function(t,e){if("object"==typeof t&&t.hasOwnProperty(o[0])&&t[o[0]]===o[1]){var n=r+"/"+e,s=i(o.slice(2));s.forEach(function(t){var e=t[0],r=n+t[1];a.applyUpdate(e,r,t.slice(2))})}});break;default:throw new Error("Unsupported op "+n)}},n.prototype.escapeToken=function(t){return t.replace(/[~\/]/g,function(t){return"~"===t?"~0":"~1"})},n.prototype.unescapeToken=function(t){return t.replace(/~./g,function(t){switch(t){case"~0":return"~";case"~1":return"/"}throw new Error("Invalid tilde escape: "+t)})},n.prototype.postUpdate=function(t,e,r,o){if("function"!=typeof o&&(o=function(){}),"string"==typeof t&&(t=n.ops[t]),"number"!=typeof t)throw new Error("Blob update op code must be a number or a valid op id string");if(0>t||t>255)throw new Error("Blob update op code out of bounds");r.unshift(e),r.unshift(t);var i={method:"POST",url:this.url+"/v1/blob/patch",dataType:"json",data:{blob_id:this.id,patch:a.encrypt(this.key,JSON.stringify(r))}},c=new s(i),l=c.signHmac(this.data.auth_secret,this.id);u.post(l.url).send(l.data).end(function(t,e){t?o(new Error("Patch could not be saved - XHR error")):e.body&&"success"===e.body.result?o(null,e.body):o(new Error("Patch could not be saved - bad result"))})},n.prototype.get2FA=function(t){var e={method:"GET",url:this.url+"/v1/blob/"+this.id+"/2FA?device_id="+this.device_id},r=new s(e),n=r.signHmac(this.data.auth_secret,this.id);u.get(n.url).end(function(e,r){e?t(e):r.body&&"success"===r.body.result?t(null,r.body):t(r.body&&"error"===r.body.result?new Error(r.body.message):new Error("Unable to retrieve settings."))})},n.prototype.set2FA=function(t,e){var r={method:"POST",url:this.url+"/v1/blob/"+this.id+"/2FA",data:{enabled:t.enabled,phone:t.phone,country_code:t.country_code}},n=new s(r),o=n.signAsymmetric(t.masterkey,this.data.account_id,this.id);u.post(o.url).send(o.data).end(function(t,r){t?e(t):r.body&&"success"===r.body.result?e(null,r.body):e(r.body&&"error"===r.body.result?r.body:new Error("Unable to update settings."))})};var g=function(t){this._getBlob=function(){return t}};g.prototype.getFullAddress=function(t){var e=this._getBlob();if(!(e&&e.data&&e.data[d]&&e.data[d].address))return"";var r=this.get("address",t),n="";return r.value.contact&&(n+=r.value.contact),r.value.line1&&(n+=" "+r.value.line1),r.value.line2&&(n+=" "+r.value.line2),r.value.city&&(n+=" "+r.value.city),r.value.region&&(n+=" "+r.value.region),r.value.postalCode&&(n+=" "+r.value.postalCode),r.value.country&&(n+=" "+r.value.country),n},g.prototype.getAll=function(t){var e=this._getBlob();if(!e||!e.data||!e.data[d])return{};var r={},n=e.data[d];for(var o in n)r[o]=this.get(o,t);return r},g.prototype.get=function(t,e){function r(t,e){var r,n={encrypted:!0};try{r=a.decrypt(t,e.value)}catch(o){return n.value=e.value,n.error=o,n}try{n.value=JSON.parse(r)}catch(o){n.value=r}return n}var n=this._getBlob();if(!n||!n.data||!n.data[d])return null;var o=n.data[d][t];return o&&o.encrypted?r(e,o):o?o:null},g.prototype.set=function(t,e,r,n){function o(t){return c?c.data?c.data[d]?t(null):void c.set("/"+d,{},function(e){return t(e?e:null)}):n(new Error("Invalid Blob")):n(new Error("Identity must be associated with a blob"))}function i(n){var o={};o[t]={encrypted:e?!0:!1,value:e?s(e,r):r},u._getBlob().extend("/"+d,o,n)}function s(t,e){return"object"==typeof e&&(e=JSON.stringify(e)),a.encrypt(t,e)}var u=this,c=this._getBlob();if(n||(n=function(){}),-1===h.indexOf(t))return n(new Error("invalid identity field"));if("address"===t){if("object"!=typeof r)return n(new Error("address must be an object"));for(var p in r)if(-1===m.indexOf(p))return n(new Error("invalid address field"))}else if("nationalID"===t){if("object"!=typeof r)return n(new Error("nationalID must be an object"));for(var f in r){if(-1===b.indexOf(f))return n(new Error("invalid nationalID field"));if("type"===f&&-1===v.indexOf(r[f]))return n(new Error("invalid nationalID type"))}}else if("entityType"===t&&-1===y.indexOf(r))return n(new Error("invalid entity type"));l.waterfall([o,i],n)},g.prototype.unset=function(t,e,r){r||(r=function(){});var n=this.get(t,e);return n&&n.error?r(n.error):void this._getBlob().unset("/"+d+"/"+t,r)},e.Blob=n,p.getRippleName=function(t,e,r){return a.isValidAddress(e)&&a.isValidAddress(e)?void u.get(t+"/v1/user/"+e,function(t,e){t?r(new Error("Unable to access vault sever")):e.body&&e.body.username?r(null,e.body.username):r(e.body&&e.body.exists===!1?new Error("No ripple name for this address"):new Error("Unable to determine if ripple name exists"))}):r(new Error("Invalid ripple address"))},p.get=function(t,e){var r=new n(t);r.init(e)},p.requestToken=function(t,e,r,n){var o={method:"GET",url:t+"/v1/blob/"+e+"/2FA/requestToken"};r&&r instanceof Function?n=r:r&&(o.url+="?force_sms=true"),u.get(o.url).end(function(t,e){t?n(t):e.body&&"success"===e.body.result?n(null,e.body):n(e.body&&"error"===e.body.result?new Error(e.body.message):new Error("Unable to request authentication token."))})},p.verifyToken=function(t,e){var r={method:"POST",url:t.url+"/v1/blob/"+t.id+"/2FA/verifyToken",data:{device_id:t.device_id,token:t.token,remember_me:t.remember_me}};u.post(r.url).send(r.data).end(function(t,r){t?e(t):r.body&&"success"===r.body.result?e(null,r.body):e(r.body&&"error"===r.body.result?new Error(r.body.message):new Error("Unable to verify authentication token."))})},p.verify=function(t,e,r,n){t+="/v1/user/"+e+"/verify/"+r,u.get(t,function(t,e){t?n(new Error("Failed to verify the account - XHR error")):e.body&&"success"===e.body.result?n(null,e.body):n(new Error("Failed to verify the account"))})},p.resendEmail=function(t,e){var r={method:"POST",url:t.url+"/v1/user/email",data:{blob_id:t.id,username:t.username,email:t.email,hostlink:t.activateLink}},n=new s(r),o=n.signAsymmetric(t.masterkey,t.account_id,t.id);u.post(o.url).send(o.data).end(function(t,r){t?(console.log("error:","resendEmail:",t),e(new Error("Failed to resend the token"))):r.body&&"success"===r.body.result?e(null,r.body):r.body&&"error"===r.body.result?(console.log("error:","resendEmail:",r.body.message),e(new Error("Failed to resend the token"))):e(new Error("Failed to resend the token"))})},p.recoverBlob=function(t,e){function r(r){var i={url:t.url,blob_id:r.body.blob_id,key:o(t.masterkey,r.body.encrypted_blobdecrypt_key)},a=new n(i);if(a.revision=r.body.revision,a.encrypted_secret=r.body.encrypted_secret,!a.decrypt(r.body.blob))return e(new Error("Error while decrypting blob"));if(r.body.patches&&r.body.patches.length){var s=!0;r.body.patches.forEach(function(t){s=s&&a.applyEncryptedPatch(t)}),s&&a.consolidate()}e(null,a)}var i=String(t.username).trim(),a={method:"GET",url:t.url+"/v1/user/recov/"+i},c=new s(a),l=c.signAsymmetricRecovery(t.masterkey,i);u.get(l.url).end(function(t,n){t?e(t):n.body&&"success"===n.body.result?n.body.encrypted_blobdecrypt_key?r(n):e(new Error("Missing encrypted blob decrypt key.")):e(n.body&&"error"===n.body.result?new Error(n.body.message):new Error("Could not recover blob"))})},p.updateKeys=function(t,e){var r=t.blob.id;t.blob.id=t.keys.id,t.blob.key=t.keys.crypt,t.blob.encrypted_secret=t.blob.encryptSecret(t.keys.unlock,t.masterkey);var n={method:"POST",url:t.blob.url+"/v1/user/"+t.username+"/updatekeys",data:{blob_id:t.blob.id,data:t.blob.encrypt(),revision:t.blob.revision,encrypted_secret:t.blob.encrypted_secret,encrypted_blobdecrypt_key:t.blob.encryptBlobCrypt(t.masterkey,t.keys.crypt)}},o=new s(n),i=o.signAsymmetric(t.masterkey,t.blob.data.account_id,r);u.post(i.url).send(i.data).end(function(t,r){t?(console.log("error:","updateKeys:",t),e(new Error("Failed to update blob - XHR error"))):r.body&&"success"===r.body.result?e(null,r.body):(console.log("error:","updateKeys:",r.body?r.body.message:null),e(new Error("Failed to update blob - bad result")))})},p.rename=function(t,e){var r=t.blob.id;t.blob.id=t.keys.id,t.blob.key=t.keys.crypt,t.blob.encryptedSecret=t.blob.encryptSecret(t.keys.unlock,t.masterkey);var n={method:"POST",url:t.blob.url+"/v1/user/"+t.username+"/rename",data:{blob_id:t.blob.id,username:t.new_username,data:t.blob.encrypt(),revision:t.blob.revision,encrypted_secret:t.blob.encryptedSecret,encrypted_blobdecrypt_key:t.blob.encryptBlobCrypt(t.masterkey,t.keys.crypt)}},o=new s(n),i=o.signAsymmetric(t.masterkey,t.blob.data.account_id,r);u.post(i.url).send(i.data).end(function(t,r){t?(console.log("error:","rename:",t),e(new Error("Failed to rename"))):r.body&&"success"===r.body.result?e(null,r.body):r.body&&"error"===r.body.result?(console.log("error:","rename:",r.body.message),e(new Error("Failed to rename"))):e(new Error("Failed to rename"))})},p.create=function(t,e){var r={url:t.url,blob_id:t.id,key:t.crypt},o=new n(r);o.revision=0,o.data={auth_secret:a.createSecret(8),account_id:a.getAddress(t.masterkey),email:t.email,contacts:[],created:(new Date).toJSON()},o.encrypted_secret=o.encryptSecret(t.unlock,t.masterkey),t.oldUserBlob&&(o.data.contacts=t.oldUserBlob.data.contacts);var i={method:"POST",url:t.url+"/v1/user",data:{blob_id:t.id,username:t.username,address:o.data.account_id,auth_secret:o.data.auth_secret,data:o.encrypt(),email:t.email,hostlink:t.activateLink,domain:t.domain,encrypted_blobdecrypt_key:o.encryptBlobCrypt(t.masterkey,t.crypt),encrypted_secret:o.encrypted_secret}},c=new s(i),l=c.signAsymmetric(t.masterkey,o.data.account_id,t.id);u.post(l.url).send(l.data).end(function(t,r){if(t)e(t);else if(r.body&&"success"===r.body.result)o.identity_id=r.body.identity_id,e(null,o,r.body);else if(r.body&&"error"===r.body.result){var t=new Error(r.body.message);r.body.missing&&(t.missing=r.body.missing),e(t)}else e(new Error("Could not create blob"))})},p.deleteBlob=function(t,e){var r={method:"DELETE",url:t.url+"/v1/user/"+t.username},n=new s(r),o=n.signAsymmetric(t.masterkey,t.account_id,t.blob_id);u.del(o.url).end(function(t,r){t?e(t):r.body&&"success"===r.body.result?e(null,r.body):r.body&&"error"===r.body.result?e(new Error(r.body.message)):r.error&&404===r.error.status?e(new Error("Blob not found")):(r.error&&console.log(r.error.toString()),e(new Error("Could not delete blob")))})},p.updateProfile=function(t,e){var r={method:"POST",url:t.url+"/v1/profile/",dataType:"json",data:t.profile},n=new s(r),o=n.signHmac(t.auth_secret,t.blob_id);u.post(o.url).send(o.data).end(function(t,r){t?(console.log("error:","updateProfile:",t),e(new Error("Failed to update profile - XHR error"))):r.body&&"success"===r.body.result?e(null,r.body):r.body?(console.log("error:","updateProfile:",r.body),e(new Error("Failed to update profile"))):e(new Error("Failed to update profile"))})},p.getProfile=function(t,e){var r={method:"GET",url:t.url+"/v1/profile/"},n=new s(r),o=n.signHmac(t.auth_secret,t.blob_id);u.get(o.url).send(o.data).end(function(t,r){t?(console.log("error:","getProfile:",t),e(new Error("Failed to get profile - XHR error"))):r.body&&"success"===r.body.result?e(null,r.body):r.body?(console.log("error:","getProfile:",r.body),e(new Error("Failed to get profile"))):e(new Error("Failed to get profile"))})},p.getAttestation=function(t,e){var r={};t.phone&&(r.phone=t.phone),t.email&&(r.email=t.email);var n={method:"POST",url:t.url+"/v1/attestation/"+t.type,dataType:"json",data:r},o=new s(n),i=o.signHmac(t.auth_secret,t.blob_id);u.post(i.url).send(i.data).end(function(t,r){t?(console.log("error:","attest:",t),e(new Error("attestation error - XHR error"))):r.body&&"success"===r.body.result?(r.body.attestation&&(r.body.decoded=p.parseAttestation(r.body.attestation)),e(null,r.body)):r.body?(console.log("error:","attestation:",r.body),e(new Error("attestation error: "+r.body.message||""))):e(new Error("attestation error"))})},p.getAttestationSummary=function(t,e){var r={method:"GET",url:t.url+"/v1/attestation/summary",dataType:"json"};t.full&&(r.url+="?full=true");var n=new s(r),o=n.signHmac(t.auth_secret,t.blob_id);u.get(o.url).send(o.data).end(function(t,r){t?(console.log("error:","attest:",t),e(new Error("attestation error - XHR error"))):r.body&&"success"===r.body.result?(r.body.attestation&&(r.body.decoded=p.parseAttestation(r.body.attestation)),e(null,r.body)):r.body?(console.log("error:","attestation:",r.body),e(new Error("attestation error: "+r.body.message||""))):e(new Error("attestation error"))})},p.updateAttestation=function(t,e){var r={};t.phone&&(r.phone=t.phone),t.profile&&(r.profile=t.profile),t.email&&(r.email=t.email),t.token&&(r.token=t.token),t.answers&&(r.answers=t.answers);var n={method:"POST",url:t.url+"/v1/attestation/"+t.type+"/update",dataType:"json",data:r},o=new s(n),i=o.signHmac(t.auth_secret,t.blob_id);u.post(i.url).send(i.data).end(function(t,r){t?(console.log("error:","attest:",t),e(new Error("attestation error - XHR error"))):r.body&&"success"===r.body.result?(r.body.attestation&&(r.body.decoded=p.parseAttestation(r.body.attestation)),e(null,r.body)):r.body?(console.log("error:","attestation:",r.body),e(new Error("attestation error: "+r.body.message||""))):e(new Error("attestation error"))})},p.parseAttestation=function(t){var e,r=decodeURIComponent(t).split(".");try{e={header:JSON.parse(a.decodeBase64(r[0])),payload:JSON.parse(a.decodeBase64(r[1])),signature:r[2]}}catch(n){console.log("invalid attestation:",n)}return e},e.BlobClient=p},function(t,e,r){var n=r(8),o=r(12),i=r(5).RippleTxt,a={};a._getRippleTxt=function(t,e){i.get(t,e)},a._getUser=function(t,e){o.get(t,e)},a.getAddress=function(t,e,r){function o(r){a._getRippleTxt(t,function(n,o){if(n)return r(n);if(!o.authinfo_url)return r(new Error("Authentication is not supported on "+t));var i=Array.isArray(o.authinfo_url)?o.authinfo_url[0]:o.authinfo_url;i+="?domain="+t+"&username="+e,r(null,i)})}function i(t,e){a._getUser(t,function(t,r){t||r.error?e(new Error("Authentication info server unreachable")):e(null,r.body)})}var a=this;n.waterfall([o,i],r)},a.get=function(t,e,r){function o(r){a._getRippleTxt(t,function(n,o){if(n)return r(n);if(!o.authinfo_url)return r(new Error("Authentication is not supported on "+t));var i=Array.isArray(o.authinfo_url)?o.authinfo_url[0]:o.authinfo_url;i+="?domain="+t+"&username="+e,r(null,i)})}function i(t,e){a._getUser(t,function(t,r){t||r.error?e(new Error("Authentication info server unreachable")):e(null,r.body)})}var a=this;n.waterfall([o,i],r)},e.AuthInfo=a},function(t,e,r){var n=r(12),o=ripple.Currency,i={txts:{}};i.urlTemplates=["https://{{domain}}/ripple.txt","https://www.{{domain}}/ripple.txt","https://ripple.{{domain}}/ripple.txt","http://{{domain}}/ripple.txt","http://www.{{domain}}/ripple.txt","http://ripple.{{domain}}/ripple.txt"],i.get=function(t,e){var r=this;return r.txts[t]?e(null,r.txts[t]):void function o(a){var s=i.urlTemplates[a];return s?(s=s.replace("{{domain}}",t),console.log(s),void n.get(s,function(n,i){if(n||!i.text)return o(++a);var s=r.parse(i.text);r.txts[t]=s,e(null,s)})):e(new Error("No ripple.txt found"))}(0)},i.parse=function(t){var e="",r={};t=t.replace(/\r?\n/g,"\n").split("\n");for(var n=0,o=t.length;o>n;n++){var i=t[n];i.length&&"#"!==i[0]&&("["===i[0]&&"]"===i[i.length-1]?(e=i.slice(1,i.length-1),r[e]=[]):(i=i.replace(/^\s+|\s+$/g,""),r[e]&&r[e].push(i)))}return r},i.extractDomain=function(t){return match=/[^.]*\.[^.]{2,3}(?:\.[^.]{2,3})?([^.\?][^\?.]+?)?$/.exec(t),match&&match[0]?match[0]:t},i.getCurrencies=function(t,e){function r(t,e){a.get(t,function(r,n){if(r)return e(r);if(r||!n.currencies||!n.accounts)return e(null,[]);var i=n.accounts[0],a=[];n.currencies.forEach(function(e){a.push({issuer:i,currency:o.from_json(e),domain:t})}),e(null,a)})}var n=i.extractDomain(t),a=this;r(n,function(n,o){return n?r(t,e):e(null,o)})},e.RippleTxt=i},function(t,e,r){function n(t,e){var r=e<<3;"string"==typeof t&&(t=a.codec.utf8String.toBits(t));for(var n=0,o=[];a.bitArray.bitLength(o)<r;){var i=a.hash.sha512.hash(a.bitArray.concat([n],t));o=a.bitArray.concat(o,i),n++}return o=a.bitArray.clamp(o,r)}function o(t,e){var r=new a.misc.hmac(t,a.hash.sha512);return a.codec.hex.fromBits(a.bitArray.bitSlice(r.encrypt(e),0,256))}function i(t){for(var e=0;8>e;e++)a.random.addEntropy(Math.random(),32,"Math.random()");return a.random.randomWords(t)}var a=ripple.sjcl,s=ripple.Base,u=ripple.Seed,c=ripple.UInt160,l=ripple.UInt256,p=r(12),f=(r(10),r(9)),d=(r(11),{}),h={cipher:"aes",mode:"ccm",ts:64,ks:256,iter:1e3};d.derive=function(t,e,r,i,s){var u;u="login"===e?["id","crypt"]:["unlock"];var c=new a.bn(String(t.exponent)),l=new a.bn(String(t.modulus)),f=new a.bn(String(t.alpha)),d=["PAKDF_1_0_0",t.host.length,t.host,r.length,r,e.length,e].join(":")+":",h=Math.ceil(Math.min(7+l.bitLength()>>>3,256)/8),y=n(d,h),m=a.codec.hex.fromBits(y),b=new a.bn(String(m)).setBitM(0),v=[d,i.length,i].join(":")+":",g=7+l.bitLength()>>>3,w=n(v,g),_=a.codec.hex.fromBits(w),k=new a.bn(String(_)).mod(l);1!==k.jacobi(l)&&(k=k.mul(f).mod(l));for(var E;E=a.bn.random(l,0),1!==E.jacobi(l););var A=E.powermodMontgomery(b.mul(c),l),x=k.mulmod(A,l),S=a.codec.hex.fromBits(x.toBits());p.post(t.url).send({info:d,signreq:S}).end(function(e,r){if(e||!r)return s(new Error("Could not query PAKDF server "+t.host));var n=r.body||r.text?JSON.parse(r.text):{};if("success"!==n.result)return s(new Error("Could not query PAKDF server "+t.host));var i=new a.bn(String(n.signres)),c=E.inverseMod(l),p=i.mulmod(c,l),f=p.toBits(),d={};u.forEach(function(t){d[t]=o(f,t)}),s(null,d)})},d.encrypt=function(t,e){t=a.codec.hex.toBits(t);var r=f(!0,{},h),n=JSON.parse(a.encrypt(t,e,r)),o=[a.bitArray.partial(8,0)],i=a.codec.base64.toBits(n.iv),s=a.codec.base64.toBits(n.ct),u=a.bitArray.concat(o,i);return u=a.bitArray.concat(u,s),a.codec.base64.fromBits(u)},d.decrypt=function(t,e){t=a.codec.hex.toBits(t);var r=a.codec.base64.toBits(e),n=a.bitArray.extract(r,0,8);if(0!==n)throw new Error("Unsupported encryption version: "+n);var o=f(!0,{},h,{iv:a.codec.base64.fromBits(a.bitArray.bitSlice(r,8,136)),ct:a.codec.base64.fromBits(a.bitArray.bitSlice(r,136))});return a.decrypt(t,JSON.stringify(o))},d.isValidAddress=function(t){return c.is_valid(t)},d.createSecret=function(t){return a.codec.hex.fromBits(i(t))},d.createMaster=function(){return s.encode_check(33,a.codec.bytes.fromBits(i(4)))},d.getAddress=function(t){return u.from_json(t).get_key().get_address().to_json()},d.hashSha512=function(t){return a.codec.hex.fromBits(a.hash.sha512.hash(t))},d.hashSha512Half=function(t){return l.from_hex(d.hashSha512(t).substr(0,64))},d.signString=function(t,e){var r=new a.misc.hmac(a.codec.hex.toBits(t),a.hash.sha512);return a.codec.hex.fromBits(r.mac(e))},d.deriveRecoveryEncryptionKeyFromSecret=function(t){var e=u.from_json(t).to_bits(),r=new a.misc.hmac(e,a.hash.sha512),n=r.mac("ripple/hmac/recovery_encryption_key/v1");return n=a.bitArray.bitSlice(n,0,256),a.codec.hex.fromBits(n)},d.base64ToBase64Url=function(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,"")},d.base64UrlToBase64=function(t){for(t=t.replace(/-/g,"+").replace(/_/g,"/");t.length%4;)t+="=";return t},d.decodeBase64=function(t){return a.codec.utf8String.fromBits(a.codec.base64.toBits(t))},e.Crypt=d},function(t,e,r){function n(t){if(o(t)){var e,r={},i=Object.keys(t).sort();for(var a in i)e=i[a],Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=n(t[e]));return r}return Array.isArray(t)?t.map(n):t}function o(t){var e=Object.prototype.hasOwnProperty,r=Object.prototype.toString;if(!t||"[object Object]"!==r.call(t)||t.nodeType||t.setInterval)return!1;var n=e.call(t,"constructor"),o=e.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!o)return!1;var i;for(i in t);return void 0===i||e.call(t,i)}var i=r(6).Crypt,a=ripple.Message,s=r(11),u=r(9),c=r(10),l=function(t){this.config=u(!0,{},t),this.config.data||(this.config.data={})};l.prototype.getStringToSign=function(t,e,r){var o=JSON.stringify(n(this.config.data)),a=[this.config.method||"GET",t.pathname||"",t.search||"","","",i.hashSha512(o).toLowerCase()].join("\n");return[r,e,i.hashSha512(a).toLowerCase()].join("\n")},l.prototype.signHmac=function(t,e){var r=u(!0,{},this.config),n=s.parse(r.url),o=p(),a="RIPPLE1-HMAC-SHA512",l=this.getStringToSign(n,o,a),f=i.signString(t,l),d=c.stringify({signature:i.base64ToBase64Url(f),signature_date:o,signature_blob_id:e,signature_type:a});return r.url+=(n.search?"&":"?")+d,r},l.prototype.signAsymmetric=function(t,e,r){var n=u(!0,{},this.config),o=s.parse(n.url),l=p(),f="RIPPLE1-ECDSA-SHA512",d=this.getStringToSign(o,l,f),h=a.signMessage(d,t),y=c.stringify({signature:i.base64ToBase64Url(h),signature_date:l,signature_blob_id:r,signature_account:e,signature_type:f});return n.url+=(o.search?"&":"?")+y,n},l.prototype.signAsymmetricRecovery=function(t,e){var r=u(!0,{},this.config),n=s.parse(r.url),o=p(),l="RIPPLE1-ECDSA-SHA512",f=this.getStringToSign(n,o,l),d=a.signMessage(f,t),h=c.stringify({signature:i.base64ToBase64Url(d),signature_date:o,signature_username:e,signature_type:l});return r.url+=(n.search?"&":"?")+h,r};var p=function(){function t(t){return(0>t||t>9?"":"0")+t}return function(){var e=new Date;return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+".000Z"
}}();e.SignedRequest=l},function(t,e,r){var n,o;(function(r){!function(){function i(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(a,arguments)}}var a,s,u={};a=this,null!=a&&(s=a.async),u.noConflict=function(){return a.async=s,u};var c=Object.prototype.toString,l=Array.isArray||function(t){return"[object Array]"===c.call(t)},p=function(t,e){if(t.forEach)return t.forEach(e);for(var r=0;r<t.length;r+=1)e(t[r],r,t)},f=function(t,e){if(t.map)return t.map(e);var r=[];return p(t,function(t,n,o){r.push(e(t,n,o))}),r},d=function(t,e,r){return t.reduce?t.reduce(e,r):(p(t,function(t,n,o){r=e(r,t,n,o)}),r)},h=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e};"undefined"!=typeof r&&r.nextTick?(u.nextTick=r.nextTick,u.setImmediate="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:u.nextTick):"function"==typeof setImmediate?(u.nextTick=function(t){setImmediate(t)},u.setImmediate=u.nextTick):(u.nextTick=function(t){setTimeout(t,0)},u.setImmediate=u.nextTick),u.each=function(t,e,r){function n(e){e?(r(e),r=function(){}):(o+=1,o>=t.length&&r())}if(r=r||function(){},!t.length)return r();var o=0;p(t,function(t){e(t,i(n))})},u.forEach=u.each,u.eachSeries=function(t,e,r){if(r=r||function(){},!t.length)return r();var n=0,o=function(){e(t[n],function(e){e?(r(e),r=function(){}):(n+=1,n>=t.length?r():o())})};o()},u.forEachSeries=u.eachSeries,u.eachLimit=function(t,e,r,n){var o=y(e);o.apply(null,[t,r,n])},u.forEachLimit=u.eachLimit;var y=function(t){return function(e,r,n){if(n=n||function(){},!e.length||0>=t)return n();var o=0,i=0,a=0;!function s(){if(o>=e.length)return n();for(;t>a&&i<e.length;)i+=1,a+=1,r(e[i-1],function(t){t?(n(t),n=function(){}):(o+=1,a-=1,o>=e.length?n():s())})}()}},m=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[u.each].concat(e))}},b=function(t,e){return function(){var r=Array.prototype.slice.call(arguments);return e.apply(null,[y(t)].concat(r))}},v=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[u.eachSeries].concat(e))}},g=function(t,e,r,n){if(e=f(e,function(t,e){return{index:e,value:t}}),n){var o=[];t(e,function(t,e){r(t.value,function(r,n){o[t.index]=n,e(r)})},function(t){n(t,o)})}else t(e,function(t,e){r(t.value,function(t){e(t)})})};u.map=m(g),u.mapSeries=v(g),u.mapLimit=function(t,e,r,n){return w(e)(t,r,n)};var w=function(t){return b(t,g)};u.reduce=function(t,e,r,n){u.eachSeries(t,function(t,n){r(e,t,function(t,r){e=r,n(t)})},function(t){n(t,e)})},u.inject=u.reduce,u.foldl=u.reduce,u.reduceRight=function(t,e,r,n){var o=f(t,function(t){return t}).reverse();u.reduce(o,e,r,n)},u.foldr=u.reduceRight;var _=function(t,e,r,n){var o=[];e=f(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){r(t.value,function(r){r&&o.push(t),e()})},function(){n(f(o.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};u.filter=m(_),u.filterSeries=v(_),u.select=u.filter,u.selectSeries=u.filterSeries;var k=function(t,e,r,n){var o=[];e=f(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){r(t.value,function(r){r||o.push(t),e()})},function(){n(f(o.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};u.reject=m(k),u.rejectSeries=v(k);var E=function(t,e,r,n){t(e,function(t,e){r(t,function(r){r?(n(t),n=function(){}):e()})},function(){n()})};u.detect=m(E),u.detectSeries=v(E),u.some=function(t,e,r){u.each(t,function(t,n){e(t,function(t){t&&(r(!0),r=function(){}),n()})},function(){r(!1)})},u.any=u.some,u.every=function(t,e,r){u.each(t,function(t,n){e(t,function(t){t||(r(!1),r=function(){}),n()})},function(){r(!0)})},u.all=u.every,u.sortBy=function(t,e,r){u.map(t,function(t,r){e(t,function(e,n){e?r(e):r(null,{value:t,criteria:n})})},function(t,e){if(t)return r(t);var n=function(t,e){var r=t.criteria,n=e.criteria;return n>r?-1:r>n?1:0};r(null,f(e.sort(n),function(t){return t.value}))})},u.auto=function(t,e){e=e||function(){};var r=h(t),n=r.length;if(!n)return e();var o={},i=[],a=function(t){i.unshift(t)},s=function(t){for(var e=0;e<i.length;e+=1)if(i[e]===t)return void i.splice(e,1)},c=function(){n--,p(i.slice(0),function(t){t()})};a(function(){if(!n){var t=e;e=function(){},t(null,o)}}),p(r,function(r){var n=l(t[r])?t[r]:[t[r]],i=function(t){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1&&(n=n[0]),t){var i={};p(h(o),function(t){i[t]=o[t]}),i[r]=n,e(t,i),e=function(){}}else o[r]=n,u.setImmediate(c)},f=n.slice(0,Math.abs(n.length-1))||[],y=function(){return d(f,function(t,e){return t&&o.hasOwnProperty(e)},!0)&&!o.hasOwnProperty(r)};if(y())n[n.length-1](i,o);else{var m=function(){y()&&(s(m),n[n.length-1](i,o))};a(m)}})},u.retry=function(t,e,r){var n=5,o=[];"function"==typeof t&&(r=e,e=t,t=n),t=parseInt(t,10)||n;var i=function(n,i){for(var a=function(t,e){return function(r){t(function(t,n){r(!t||e,{err:t,result:n})},i)}};t;)o.push(a(e,!(t-=1)));u.series(o,function(t,e){e=e[e.length-1],(n||r)(e.err,e.result)})};return r?i():i},u.waterfall=function(t,e){if(e=e||function(){},!l(t)){var r=new Error("First argument to waterfall must be an array of functions");return e(r)}if(!t.length)return e();var n=function(t){return function(r){if(r)e.apply(null,arguments),e=function(){};else{var o=Array.prototype.slice.call(arguments,1),i=t.next();o.push(i?n(i):e),u.setImmediate(function(){t.apply(null,o)})}}};n(u.iterator(t))()};var A=function(t,e,r){if(r=r||function(){},l(e))t.map(e,function(t,e){t&&t(function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),e.call(null,t,r)})},r);else{var n={};t.each(h(e),function(t,r){e[t](function(e){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),n[t]=o,r(e)})},function(t){r(t,n)})}};u.parallel=function(t,e){A({map:u.map,each:u.each},t,e)},u.parallelLimit=function(t,e,r){A({map:w(e),each:y(e)},t,r)},u.series=function(t,e){if(e=e||function(){},l(t))u.mapSeries(t,function(t,e){t&&t(function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),e.call(null,t,r)})},e);else{var r={};u.eachSeries(h(t),function(e,n){t[e](function(t){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),r[e]=o,n(t)})},function(t){e(t,r)})}},u.iterator=function(t){var e=function(r){var n=function(){return t.length&&t[r].apply(null,arguments),n.next()};return n.next=function(){return r<t.length-1?e(r+1):null},n};return e(0)},u.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var x=function(t,e,r,n){var o=[];t(e,function(t,e){r(t,function(t,r){o=o.concat(r||[]),e(t)})},function(t){n(t,o)})};u.concat=m(x),u.concatSeries=v(x),u.whilst=function(t,e,r){t()?e(function(n){return n?r(n):void u.whilst(t,e,r)}):r()},u.doWhilst=function(t,e,r){t(function(n){if(n)return r(n);var o=Array.prototype.slice.call(arguments,1);e.apply(null,o)?u.doWhilst(t,e,r):r()})},u.until=function(t,e,r){t()?r():e(function(n){return n?r(n):void u.until(t,e,r)})},u.doUntil=function(t,e,r){t(function(n){if(n)return r(n);var o=Array.prototype.slice.call(arguments,1);e.apply(null,o)?r():u.doUntil(t,e,r)})},u.queue=function(t,e){function r(t,e,r,n){return t.started||(t.started=!0),l(e)||(e=[e]),0==e.length?u.setImmediate(function(){t.drain&&t.drain()}):void p(e,function(e){var o={data:e,callback:"function"==typeof n?n:null};r?t.tasks.unshift(o):t.tasks.push(o),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),u.setImmediate(t.process)})}void 0===e&&(e=1);var n=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(t,e){r(o,t,!1,e)},kill:function(){o.drain=null,o.tasks=[]},unshift:function(t,e){r(o,t,!0,e)},process:function(){if(!o.paused&&n<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),n+=1;var r=function(){n-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+n===0&&o.drain(),o.process()},a=i(r);t(e.data,a)}},length:function(){return o.tasks.length},running:function(){return n},idle:function(){return o.tasks.length+n===0},pause:function(){o.paused!==!0&&(o.paused=!0,o.process())},resume:function(){o.paused!==!1&&(o.paused=!1,o.process())}};return o},u.priorityQueue=function(t,e){function r(t,e){return t.priority-e.priority}function n(t,e,r){for(var n=-1,o=t.length-1;o>n;){var i=n+(o-n+1>>>1);r(e,t[i])>=0?n=i:o=i-1}return n}function o(t,e,o,i){return t.started||(t.started=!0),l(e)||(e=[e]),0==e.length?u.setImmediate(function(){t.drain&&t.drain()}):void p(e,function(e){var a={data:e,priority:o,callback:"function"==typeof i?i:null};t.tasks.splice(n(t.tasks,a,r)+1,0,a),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),u.setImmediate(t.process)})}var i=u.queue(t,e);return i.push=function(t,e,r){o(i,t,e,r)},delete i.unshift,i},u.cargo=function(t,e){var r=!1,n=[],o={tasks:n,payload:e,saturated:null,empty:null,drain:null,drained:!0,push:function(t,r){l(t)||(t=[t]),p(t,function(t){n.push({data:t,callback:"function"==typeof r?r:null}),o.drained=!1,o.saturated&&n.length===e&&o.saturated()}),u.setImmediate(o.process)},process:function i(){if(!r){if(0===n.length)return o.drain&&!o.drained&&o.drain(),void(o.drained=!0);var a="number"==typeof e?n.splice(0,e):n.splice(0,n.length),s=f(a,function(t){return t.data});o.empty&&o.empty(),r=!0,t(s,function(){r=!1;var t=arguments;p(a,function(e){e.callback&&e.callback.apply(null,t)}),i()})}},length:function(){return n.length},running:function(){return r}};return o};var S=function(t){return function(e){var r=Array.prototype.slice.call(arguments,1);e.apply(null,r.concat([function(e){var r=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&p(r,function(e){console[t](e)}))}]))}};u.log=S("log"),u.dir=S("dir"),u.memoize=function(t,e){var r={},n={};e=e||function(t){return t};var o=function(){var o=Array.prototype.slice.call(arguments),i=o.pop(),a=e.apply(null,o);a in r?u.nextTick(function(){i.apply(null,r[a])}):a in n?n[a].push(i):(n[a]=[i],t.apply(null,o.concat([function(){r[a]=arguments;var t=n[a];delete n[a];for(var e=0,o=t.length;o>e;e++)t[e].apply(null,arguments)}])))};return o.memo=r,o.unmemoized=t,o},u.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},u.times=function(t,e,r){for(var n=[],o=0;t>o;o++)n.push(o);return u.map(n,e,r)},u.timesSeries=function(t,e,r){for(var n=[],o=0;t>o;o++)n.push(o);return u.mapSeries(n,e,r)},u.seq=function(){var t=arguments;return function(){var e=this,r=Array.prototype.slice.call(arguments),n=r.pop();u.reduce(t,r,function(t,r,n){r.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);n(t,e)}]))},function(t,r){n.apply(e,[t].concat(r))})}},u.compose=function(){return u.seq.apply(null,Array.prototype.reverse.call(arguments))};var T=function(t,e){var r=function(){var r=this,n=Array.prototype.slice.call(arguments),o=n.pop();return t(e,function(t,e){t.apply(r,n.concat([e]))},o)};if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return r.apply(this,n)}return r};u.applyEach=m(T),u.applyEachSeries=v(T),u.forever=function(t,e){function r(n){if(n){if(e)return e(n);throw n}t(r)}r()},"undefined"!=typeof t&&t.exports?t.exports=u:(n=[],o=function(){return u}.apply(e,n),!(void 0!==o&&(t.exports=o)))}()}).call(e,r(15))},function(t){var e,r=Object.prototype.hasOwnProperty,n=Object.prototype.toString,o=function(t){"use strict";if(!t||"[object Object]"!==n.call(t))return!1;var o=r.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!o&&!i)return!1;var a;for(a in t);return a===e||r.call(t,a)};t.exports=function i(){"use strict";var t,r,n,a,s,u,c=arguments[0],l=1,p=arguments.length,f=!1;for("boolean"==typeof c?(f=c,c=arguments[1]||{},l=2):("object"!=typeof c&&"function"!=typeof c||null==c)&&(c={});p>l;++l)if(t=arguments[l],null!=t)for(r in t)n=c[r],a=t[r],c!==a&&(f&&a&&(o(a)||(s=Array.isArray(a)))?(s?(s=!1,u=n&&Array.isArray(n)?n:[]):u=n&&o(n)?n:{},c[r]=i(f,u,a)):a!==e&&(c[r]=a));return c}},function(t,e,r){"use strict";e.decode=e.parse=r(13),e.encode=e.stringify=r(14)},function(t,e,r){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,r){if(t&&c(t)&&t instanceof n)return t;var o=new n;return o.parse(t,e,r),o}function i(t){return u(t)&&(t=o(t)),t instanceof n?t.format():n.prototype.format.call(t)}function a(t,e){return o(t,!1,!0).resolve(e)}function s(t,e){return t?o(t,!1,!0).resolveObject(e):e}function u(t){return"string"==typeof t}function c(t){return"object"==typeof t&&null!==t}function l(t){return null===t}function p(t){return null==t}var f=r(16);e.parse=o,e.resolve=a,e.resolveObject=s,e.format=i,e.Url=n;var d=/^([a-z0-9.+-]+:)/i,h=/:[0-9]*$/,y=["<",">",'"',"`"," ","\r","\n","	"],m=["{","}","|","\\","^","`"].concat(y),b=["'"].concat(m),v=["%","/","?",";","#"].concat(b),g=["/","?","#"],w=255,_=/^[a-z0-9A-Z_-]{0,63}$/,k=/^([a-z0-9A-Z_-]{0,63})(.*)$/,E={javascript:!0,"javascript:":!0},A={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},S=r(10);n.prototype.parse=function(t,e,r){if(!u(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t;n=n.trim();var o=d.exec(n);if(o){o=o[0];var i=o.toLowerCase();this.protocol=i,n=n.substr(o.length)}if(r||o||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var a="//"===n.substr(0,2);!a||o&&A[o]||(n=n.substr(2),this.slashes=!0)}if(!A[o]&&(a||o&&!x[o])){for(var s=-1,c=0;c<g.length;c++){var l=n.indexOf(g[c]);-1!==l&&(-1===s||s>l)&&(s=l)}var p,h;h=-1===s?n.lastIndexOf("@"):n.lastIndexOf("@",s),-1!==h&&(p=n.slice(0,h),n=n.slice(h+1),this.auth=decodeURIComponent(p)),s=-1;for(var c=0;c<v.length;c++){var l=n.indexOf(v[c]);-1!==l&&(-1===s||s>l)&&(s=l)}-1===s&&(s=n.length),this.host=n.slice(0,s),n=n.slice(s),this.parseHost(),this.hostname=this.hostname||"";var y="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!y)for(var m=this.hostname.split(/\./),c=0,T=m.length;T>c;c++){var j=m[c];if(j&&!j.match(_)){for(var O="",C=0,U=j.length;U>C;C++)O+=j.charCodeAt(C)>127?"x":j[C];if(!O.match(_)){var I=m.slice(0,c),B=m.slice(c+1),P=j.match(k);P&&(I.push(P[1]),B.unshift(P[2])),B.length&&(n="/"+B.join(".")+n),this.hostname=I.join(".");break}}}if(this.hostname=this.hostname.length>w?"":this.hostname.toLowerCase(),!y){for(var R=this.hostname.split("."),L=[],c=0;c<R.length;++c){var q=R[c];L.push(q.match(/[^A-Za-z0-9_-]/)?"xn--"+f.encode(q):q)}this.hostname=L.join(".")}var H=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+H,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!E[i])for(var c=0,T=b.length;T>c;c++){var D=b[c],M=encodeURIComponent(D);M===D&&(M=escape(D)),n=n.split(D).join(M)}var K=n.indexOf("#");-1!==K&&(this.hash=n.substr(K),n=n.slice(0,K));var N=n.indexOf("?");if(-1!==N?(this.search=n.substr(N),this.query=n.substr(N+1),e&&(this.query=S.parse(this.query)),n=n.slice(0,N)):e&&(this.search="",this.query={}),n&&(this.pathname=n),x[i]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var H=this.pathname||"",q=this.search||"";this.path=H+q}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(i=S.stringify(this.query));var a=this.search||i&&"?"+i||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||x[e])&&o!==!1?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),a=a.replace("#","%23"),e+o+r+a+n},n.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(u(t)){var e=new n;e.parse(t,!1,!0),t=e}var r=new n;if(Object.keys(this).forEach(function(t){r[t]=this[t]},this),r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(r[e]=t[e])}),x[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(t.protocol&&t.protocol!==r.protocol){if(!x[t.protocol])return Object.keys(t).forEach(function(e){r[e]=t[e]}),r.href=r.format(),r;if(r.protocol=t.protocol,t.host||A[t.protocol])r.pathname=t.pathname;else{for(var o=(t.pathname||"").split("/");o.length&&!(t.host=o.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),r.pathname=o.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var i=r.pathname||"",a=r.search||"";r.path=i+a}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var s=r.pathname&&"/"===r.pathname.charAt(0),c=t.host||t.pathname&&"/"===t.pathname.charAt(0),f=c||s||r.host&&t.pathname,d=f,h=r.pathname&&r.pathname.split("/")||[],o=t.pathname&&t.pathname.split("/")||[],y=r.protocol&&!x[r.protocol];if(y&&(r.hostname="",r.port=null,r.host&&(""===h[0]?h[0]=r.host:h.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===o[0]?o[0]=t.host:o.unshift(t.host)),t.host=null),f=f&&(""===o[0]||""===h[0])),c)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,h=o;else if(o.length)h||(h=[]),h.pop(),h=h.concat(o),r.search=t.search,r.query=t.query;else if(!p(t.search)){if(y){r.hostname=r.host=h.shift();var m=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;m&&(r.auth=m.shift(),r.host=r.hostname=m.shift())}return r.search=t.search,r.query=t.query,l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!h.length)return r.pathname=null,r.path=r.search?"/"+r.search:null,r.href=r.format(),r;for(var b=h.slice(-1)[0],v=(r.host||t.host)&&("."===b||".."===b)||""===b,g=0,w=h.length;w>=0;w--)b=h[w],"."==b?h.splice(w,1):".."===b?(h.splice(w,1),g++):g&&(h.splice(w,1),g--);if(!f&&!d)for(;g--;g)h.unshift("..");!f||""===h[0]||h[0]&&"/"===h[0].charAt(0)||h.unshift(""),v&&"/"!==h.join("/").substr(-1)&&h.push("");var _=""===h[0]||h[0]&&"/"===h[0].charAt(0);if(y){r.hostname=r.host=_?"":h.length?h.shift():"";var m=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;m&&(r.auth=m.shift(),r.host=r.hostname=m.shift())}return f=f||r.host&&h.length,f&&!_&&h.unshift(""),h.length?r.pathname=h.join("/"):(r.pathname=null,r.path=null),l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var t=this.host,e=h.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,r){function n(){}function o(t){var e={}.toString.call(t);switch(e){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function i(){if(b.XMLHttpRequest&&("file:"!=b.location.protocol||!b.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function a(t){return t===Object(t)}function s(t){if(!a(t))return t;var e=[];for(var r in t)null!=t[r]&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}function u(t){for(var e,r,n={},o=t.split("&"),i=0,a=o.length;a>i;++i)r=o[i],e=r.split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return n}function c(t){var e,r,n,o,i=t.split(/\r?\n/),a={};i.pop();for(var s=0,u=i.length;u>s;++s)r=i[s],e=r.indexOf(":"),n=r.slice(0,e).toLowerCase(),o=v(r.slice(e+1)),a[n]=o;return a}function l(t){return t.split(/ *; */).shift()}function p(t){return m(t.split(/ *; */),function(t,e){var r=e.split(/ *= */),n=r.shift(),o=r.shift();return n&&o&&(t[n]=o),t},{})}function f(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method?this.xhr.responseText:null,this.setStatusProperties(this.xhr.status),this.header=this.headers=c(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text):null}function d(t,e){var r=this;y.call(this),this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new f(r)}catch(n){t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=n}r.callback(t,e)})}function h(t,e){return"function"==typeof e?new d("GET",t).end(e):1==arguments.length?new d("GET",t):new d(t,e)}var y=r(17),m=r(18),b="undefined"==typeof window?this:window,v="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};h.serializeObject=s,h.parseString=u,h.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},h.serialize={"application/x-www-form-urlencoded":s,"application/json":JSON.stringify},h.parse={"application/x-www-form-urlencoded":u,"application/json":JSON.parse},f.prototype.get=function(t){return this.header[t.toLowerCase()]},f.prototype.setHeaderProperties=function(){var t=this.header["content-type"]||"";this.type=l(t);var e=p(t);for(var r in e)this[r]=e[r]},f.prototype.parseBody=function(t){var e=h.parse[this.type];return e&&t&&t.length?e(t):null},f.prototype.setStatusProperties=function(t){var e=t/100|0;this.status=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=4==e||5==e?this.toError():!1,this.accepted=202==t,this.noContent=204==t||1223==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},f.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,n="cannot "+e+" "+r+" ("+this.status+")",o=new Error(n);return o.status=this.status,o.method=e,o.url=r,o},h.Response=f,y(d.prototype),d.prototype.use=function(t){return t(this),this},d.prototype.timeout=function(t){return this._timeout=t,this},d.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},d.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this)},d.prototype.set=function(t,e){if(a(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},d.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},d.prototype.getHeader=function(t){return this._header[t.toLowerCase()]},d.prototype.type=function(t){return this.set("Content-Type",h.types[t]||t),this},d.prototype.accept=function(t){return this.set("Accept",h.types[t]||t),this},d.prototype.auth=function(t,e){var r=btoa(t+":"+e);return this.set("Authorization","Basic "+r),this},d.prototype.query=function(t){return"string"!=typeof t&&(t=s(t)),t&&this._query.push(t),this},d.prototype.field=function(t,e){return this._formData||(this._formData=new FormData),this._formData.append(t,e),this},d.prototype.attach=function(t,e,r){return this._formData||(this._formData=new FormData),this._formData.append(t,e,r),this},d.prototype.send=function(t){var e=a(t),r=this.getHeader("Content-Type");if(e&&a(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),r=this.getHeader("Content-Type"),this._data="application/x-www-form-urlencoded"==r?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return e?(r||this.type("json"),this):this},d.prototype.callback=function(t,e){var r=this._callback;return this.clearTimeout(),2==r.length?r(t,e):t?this.emit("error",t):void r(e)},d.prototype.crossDomainError=function(){var t=new Error("Origin is not allowed by Access-Control-Allow-Origin");t.crossDomain=!0,this.callback(t)},d.prototype.timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},d.prototype.withCredentials=function(){return this._withCredentials=!0,this},d.prototype.end=function(t){var e=this,r=this.xhr=i(),a=this._query.join("&"),s=this._timeout,u=this._formData||this._data;if(this._callback=t||n,r.onreadystatechange=function(){return 4==r.readyState?0==r.status?e.aborted?e.timeoutError():e.crossDomainError():void e.emit("end"):void 0},r.upload&&(r.upload.onprogress=function(t){t.percent=t.loaded/t.total*100,e.emit("progress",t)}),s&&!this._timer&&(this._timer=setTimeout(function(){e.abort()},s)),a&&(a=h.serializeObject(a),this.url+=~this.url.indexOf("?")?"&"+a:"?"+a),r.open(this.method,this.url,!0),this._withCredentials&&(r.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof u&&!o(u)){var c=h.serialize[this.getHeader("Content-Type")];c&&(u=c(u))}for(var l in this.header)null!=this.header[l]&&r.setRequestHeader(l,this.header[l]);return this.emit("request",this),r.send(u),this},h.Request=d,h.get=function(t,e,r){var n=h("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},h.head=function(t,e,r){var n=h("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},h.del=function(t,e){var r=h("DELETE",t);return e&&r.end(e),r},h.patch=function(t,e,r){var n=h("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},h.post=function(t,e,r){var n=h("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},h.put=function(t,e,r){var n=h("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},t.exports=h},function(t){"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,n,o,i){n=n||"&",o=o||"=";var a={};if("string"!=typeof t||0===t.length)return a;var s=/\+/g;t=t.split(n);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var l=0;c>l;++l){var p,f,d,h,y=t[l].replace(s,"%20"),m=y.indexOf(o);m>=0?(p=y.substr(0,m),f=y.substr(m+1)):(p=y,f=""),d=decodeURIComponent(p),h=decodeURIComponent(f),e(a,d)?r(a[d])?a[d].push(h):a[d]=[a[d],h]:a[d]=h}return a};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t){"use strict";function e(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,i,a,s){return i=i||"&",a=a||"=",null===t&&(t=void 0),"object"==typeof t?e(o(t),function(o){var s=encodeURIComponent(r(o))+a;return n(t[o])?e(t[o],function(t){return s+encodeURIComponent(r(t))}).join(i):s+encodeURIComponent(r(t[o]))}).join(i):s?encodeURIComponent(r(s))+a+encodeURIComponent(r(t)):""};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},function(t){function e(){}var r=t.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.MutationObserver,r="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};var n=[];if(e){var o=document.createElement("div"),i=new MutationObserver(function(){var t=n.slice();n.length=0,t.forEach(function(t){t()})});return i.observe(o,{attributes:!0}),function(t){n.length||o.setAttribute("yes","no"),n.push(t)}}return r?(window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}):function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=e,r.addListener=e,r.once=e,r.off=e,r.removeListener=e,r.removeAllListeners=e,r.emit=e,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},function(t,e,r){var n;(function(t,o){!function(i){function a(t){throw RangeError(I[t])}function s(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function u(t,e){var r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(U,".");var o=t.split("."),i=s(o,e).join(".");return n+i}function c(t){for(var e,r,n=[],o=0,i=t.length;i>o;)e=t.charCodeAt(o++),e>=55296&&56319>=e&&i>o?(r=t.charCodeAt(o++),56320==(64512&r)?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),o--)):n.push(e);return n}function l(t){return s(t,function(t){var e="";return t>65535&&(t-=65536,e+=R(t>>>10&1023|55296),t=56320|1023&t),e+=R(t)}).join("")}function p(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:_}function f(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function d(t,e,r){var n=0;for(t=r?P(t/x):t>>1,t+=P(t/e);t>B*E>>1;n+=_)t=P(t/B);return P(n+(B+1)*t/(t+A))}function h(t){var e,r,n,o,i,s,u,c,f,h,y=[],m=t.length,b=0,v=T,g=S;for(r=t.lastIndexOf(j),0>r&&(r=0),n=0;r>n;++n)t.charCodeAt(n)>=128&&a("not-basic"),y.push(t.charCodeAt(n));for(o=r>0?r+1:0;m>o;){for(i=b,s=1,u=_;o>=m&&a("invalid-input"),c=p(t.charCodeAt(o++)),(c>=_||c>P((w-b)/s))&&a("overflow"),b+=c*s,f=g>=u?k:u>=g+E?E:u-g,!(f>c);u+=_)h=_-f,s>P(w/h)&&a("overflow"),s*=h;e=y.length+1,g=d(b-i,e,0==i),P(b/e)>w-v&&a("overflow"),v+=P(b/e),b%=e,y.splice(b++,0,v)}return l(y)}function y(t){var e,r,n,o,i,s,u,l,p,h,y,m,b,v,g,A=[];for(t=c(t),m=t.length,e=T,r=0,i=S,s=0;m>s;++s)y=t[s],128>y&&A.push(R(y));for(n=o=A.length,o&&A.push(j);m>n;){for(u=w,s=0;m>s;++s)y=t[s],y>=e&&u>y&&(u=y);for(b=n+1,u-e>P((w-r)/b)&&a("overflow"),r+=(u-e)*b,e=u,s=0;m>s;++s)if(y=t[s],e>y&&++r>w&&a("overflow"),y==e){for(l=r,p=_;h=i>=p?k:p>=i+E?E:p-i,!(h>l);p+=_)g=l-h,v=_-h,A.push(R(f(h+g%v,0))),l=P(g/v);A.push(R(f(l,0))),i=d(r,b,n==o),r=0,++n}++r,++e}return A.join("")}function m(t){return u(t,function(t){return O.test(t)?h(t.slice(4).toLowerCase()):t})}function b(t){return u(t,function(t){return C.test(t)?"xn--"+y(t):t})}var v=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof o&&o);(v.global===v||v.window===v||v.self===v)&&(i=v);var g,w=2147483647,_=36,k=1,E=26,A=38,x=700,S=72,T=128,j="-",O=/^xn--/,C=/[^\x20-\x7E]/,U=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},B=_-k,P=Math.floor,R=String.fromCharCode;g={version:"1.3.2",ucs2:{decode:c,encode:l},decode:h,encode:y,toASCII:b,toUnicode:m},n=function(){return g}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))}(this)}).call(e,r(19)(t),function(){return this}())},function(t){function e(t){return t?r(t):void 0}function r(t){for(var r in e.prototype)t[r]=e.prototype[r];return t}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},e.prototype.once=function(t,e){function r(){n.off(t,r),e.apply(this,arguments)
}var n=this;return this._callbacks=this._callbacks||{},r.fn=e,this.on(t,r),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks[t];if(!r)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var n,o=0;o<r.length;o++)if(n=r[o],n===e||n.fn===e){r.splice(o,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var n=0,o=r.length;o>n;++n)r[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t){t.exports=function(t,e,r){for(var n=0,o=t.length,i=3==arguments.length?r:t[n++];o>n;)i=e.call(null,i,t[n],++n,t);return i}},function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}]);